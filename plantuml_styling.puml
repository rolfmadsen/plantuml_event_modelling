' EventModeling-PlantUML
' Version 4.1 - Final Syntax Correction

' ##################################
' ##          STYLING             ##
' ##################################

skinparam defaultTextAlignment center
skinparam wrapWidth 200
skinparam shadowing false
skinparam roundcorner 5
skinparam defaultFontName "Segoe UI", "Helvetica", "Arial"
skinparam defaultFontSize 14

' Style for the slice containers
skinparam package {
  BorderColor #AAAAAA
  BorderStyle solid
  FontColor #555555
  StereotypeFontSize 0
  TitleAlignment left
}

!$EM_COMMAND_BG = "#BDE0FE"
!$EM_COMMAND_BORDER = "#4361EE"
!$EM_EVENT_BG = "#FFE2B8"
!$EM_EVENT_BORDER = "#FC9E4F"
!$EM_READMODEL_BG = "#D9ED92"
!$EM_READMODEL_BORDER = "#76C893"
!$EM_SYSTEM_BG = "#EAEAEA"
!$EM_SYSTEM_BORDER = "#BDBDBD"
!$EM_POLICY_BG = "#E0BBEA"
!$EM_POLICY_BORDER = "#957DAD"
!$EM_TRIGGER_BG = "#FFFFFF"
!$EM_TRIGGER_BORDER = "#666666"

' CORRECTED: All skinparam blocks are now in the required multi-line format.
skinparam rectangle<<Command>> {
  BackgroundColor $EM_COMMAND_BG
  BorderColor $EM_COMMAND_BORDER
  FontColor $EM_COMMAND_BORDER
}
skinparam rectangle<<Event>> {
  BackgroundColor $EM_EVENT_BG
  BorderColor $EM_EVENT_BORDER
  FontColor $EM_EVENT_BORDER
}
skinparam rectangle<<"Read Model">> {
  BackgroundColor $EM_READMODEL_BG
  BorderColor $EM_READMODEL_BORDER
  FontColor $EM_READMODEL_BORDER
}
skinparam rectangle<<"External System">> {
  BackgroundColor $EM_SYSTEM_BG
  BorderColor $EM_SYSTEM_BORDER
  FontColor #555555
}
skinparam agent<<Policy>> {
  BackgroundColor $EM_POLICY_BG
  BorderColor $EM_POLICY_BORDER
  FontColor $EM_POLICY_BORDER
}
skinparam actor {
  BackgroundColor #FFFFFF
  BorderColor #666666
}
skinparam rectangle<<Trigger>> {
  BackgroundColor $EM_TRIGGER_BG
  BorderColor $EM_TRIGGER_BORDER
  FontColor #333333
}
skinparam queue<<Automation>> {
    BackgroundColor #FFFFFF
    BorderColor #666666
}

' ##################################
' ##          ELEMENTS            ##
' ##################################

!define Command(alias, label) rectangle "label" <<Command>> as alias
!define Event(alias, label) rectangle "label" <<Event>> as alias
!define System(alias, label) rectangle "label" <<External System>> as alias
!define Read_Model(alias, label) rectangle "label" <<"Read Model">> as alias
!define Trigger(alias, label) rectangle "label" <<Trigger>> as alias
!define Automation(alias, label) queue "==label" as alias <<$gear>> <<Automation>>

' ##################################
' ##          SLICES              ##
' ##################################

!define EventModel_Slice(name, alias) package "slice: name" as alias

' ##################################
' ##       RELATIONSHIPS          ##
' ##################################
!definelong Rel(e_source, e_target, e_label, e_direction)
e_source e_direction e_target : e_label
!enddefinelong
!define Flow(from, to, label="") Rel(from, to, label, "-->")
